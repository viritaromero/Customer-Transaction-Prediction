# -*- coding: utf-8 -*-
"""Customer Transaction Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1CaxaItTzju22SrJ-8OFzodCEqhvMyixc

# Santander Customer Transaction Prediction

# Importing libraries:
"""

import os
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sn
from datetime import datetime
from scipy import stats
from sklearn.metrics import accuracy_score

#Upgrading XGBoost
!pip install --upgrade xgboost

"""# Loading and checking the data

# Cleaning the data for the training step
"""

df_train = pd.read_csv('train.csv')
df_train.head(5)

df_test =pd.read_csv('test.csv')
df_test.head()

train_columns = df_train.drop(['ID_code','target'],axis =1).columns
train_columns

"""# Creating the model with XGBoost"""

import xgboost as xgb
d_train = xgb.DMatrix(df_train[train_columns],label = df_train['target'])
d_test = xgb.DMatrix(df_test[train_columns])

"""# Parameters"""

param_grid = {'max_depth':5,
                   'silent':1,
                   'eta':0.1, # Learning Rate
                   'gamma':0,
                   'min_child_weight':0.2784483175645849,
                   'objective':'binary:logistic',
                  }

xgbmodel = xgb.train(param_grid, d_train,500)
preds = xgbmodel.predict(d_test)

cv_results = xgb.cv(d_train())

"""# Predictions"""

predictions = df_test[['ID_code']]
predictions['target']=preds

predictions.head()

# saving results
predictions.to_csv("submissions.csv", index=False)

"""**Use this line to download your files to your computer:**"""

from google.colab import files
files.download('submissions.csv')

submission = pd.read_csv('submissions.csv')
submission.info()